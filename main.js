!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}function n(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var r=function(){return e=function e(t,n,r,o){var i=o.handleCardClick,u=o.handleDeleteCard,a=o.handleAddLike,c=o.handleRemoveLike;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cardData=t,this._src=t.link,this._alt="imagen de ".concat(t.name),this._text=t.name,this._user=r,this._cardSelector=n,this._handleCardClick=i,this._handleDeleteCard=u,this._handleAddLike=a,this._handleRemoveLike=c},(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__photo").addEventListener("click",(function(){e._handleCardClick(e._src,e._text)})),this._element.querySelector(".element__button-heart").addEventListener("click",(function(t){e._handleLikeCard(t)})),this._element.querySelector(".element__button-trash").addEventListener("click",(function(t){e._handleDeleteCard(e._cardData._id,(function(){e._element.remove()}))}))}},{key:"_handleLikeCard",value:function(e){var t=this,n=this._element.querySelector(".element__counter");this._cardData.likes.some((function(e){return e._id===t._user._id}))?this._handleRemoveLike(this._cardData._id).then((function(r){t._cardData=r,e.target.classList.remove("element__button-heart_active"),n.textContent=t._cardData.likes.length})):this._handleAddLike(this._cardData._id).then((function(r){t._cardData=r,e.target.classList.add("element__button-heart_active"),n.textContent=t._cardData.likes.length}))}},{key:"_handleDeleteCard",value:function(e){this._element.remove()}},{key:"createCard",value:function(){var e=this;this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__photo").src=this._src,this._element.querySelector(".element__photo").alt=this._alt,this._element.querySelector(".element__text").textContent=this._text;var t=this._element.querySelector(".element__button-trash"),n=this._element.querySelector(".element__button-heart");return this._user._id!==this._cardData.owner._id&&t.remove(),this._cardData.likes.some((function(t){return t._id===e._user._id}))&&(n.classList.add("element__button-heart_active"),this._element.querySelector(".element__counter").textContent=this._cardData.likes.length),this._element}}])&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),o=document.querySelector(".elements"),i=document.getElementById("popUp-Profile"),u=document.querySelector(".profile__edit-button"),a=document.querySelector(".popup-image"),c=(document.querySelector(".pop-up__image-zoom"),document.querySelector(".pop-up__image-title"),document.querySelector(".pop-up__form")),l=document.querySelector(".profile__info-name"),s=document.querySelector(".profile__info-paragraph"),f=c.querySelector(".pop-up__form-item-name"),p=c.querySelector(".pop-up__form-item-about"),y=document.getElementById("popUp-Card"),m=(document.getElementById("popUp-Form"),document.querySelector(".profile__add-button")),d=document.querySelector("#popUp-Delete"),h=document.getElementById("popUp-Avatar"),b=document.querySelector(".profile__avatar_update"),v={formElement:".pop-up__form",inputElement:".pop-up__form-item",submitButton:".pop-up__save-button",errorNode:".pop-up__form-error_",errorClass:"pop-up__form-item_error"};function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e){if("object"!=_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_(t)?t:t+""}var E=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formConfig=t,this._formElement=n,this._inputElements=Array.from(n.querySelectorAll(t.inputElement)),this._submitButton=n.querySelector(t.submitButton)},(t=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("".concat(this._formConfig.errorNode).concat(e.name));e.classList.add(this._formConfig.errorClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("".concat(this._formConfig.errorNode).concat(e.name));e.classList.remove(this._formConfig.errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputElements.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this._inputElements)?this._submitButton.disabled=!0:this._submitButton.disabled=!1}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputElements.forEach((function(t){t.addEventListener("input",(function(n){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function j(e){var t=function(e){if("object"!=w(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:t+""}var P=function(){return e=function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initialArray=r,this._renderer=o,this._container=n},(t=[{key:"renderItems",value:function(){var e=this;this._initialArray.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.appendChild(e)}}])&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var q=function(){return e=function e(t){var n,r,o,i=this,u=t.popupSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,o=function(e){"Escape"===e.key&&i.close()},(r=L(r="_handleEscClose"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this._popUp=u,this._handleEscClose=this._handleEscClose.bind(this),this._closeButton=this._popUp.querySelector(".pop-up__close-button")},(t=[{key:"open",value:function(){this._popUp.classList.add("pop-up_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popUp.classList.remove("pop-up_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",(function(){e.close()})),this._popUp.addEventListener("click",(function(t){t.target.classList.contains("pop-up")&&e.close()}))}}])&&O(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,I(r.key),r)}}function I(e){var t=function(e){if("object"!=U(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U(t)?t:t+""}function D(e,t,n){return t=A(t),function(e,t){if(t&&("object"==U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,R()?Reflect.construct(t,n||[],A(e).constructor):t.apply(e,n))}function R(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}function x(e,t,n,r){var o=B(A(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},B.apply(null,arguments)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}var F=function(e){function t(e){var n,r=e.popupSelector,o=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=D(this,t,[{popupSelector:r}]))._handleFormSubmit=o,n._formElement=n._popUp.querySelector(".pop-up__form"),n._inputList=n._formElement.querySelectorAll(".pop-up__form-item"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),n=t,(r=[{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}},{key:"setEventListeners",value:function(){var e=this;x(t,"setEventListeners",this,3)([]),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._formElement.querySelector(".pop-up__save-button").textContent="Guardando...",e._handleFormSubmit(e._getInputValues()).then((function(){e._formElement.querySelector(".pop-up__save-button").textContent="Guardar",e.close()}))}))}},{key:"close",value:function(){x(t,"close",this,3)([]),this._formElement.reset()}}])&&T(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(q);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,J(r.key),r)}}function J(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}function Z(e,t,n){return t=M(t),function(e,t){if(t&&("object"==N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,G()?Reflect.construct(t,n||[],M(e).constructor):t.apply(e,n))}function G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(G=function(){return!!e})()}function H(){return H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},H.apply(null,arguments)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}var Q=function(e){function t(e){var n,r=e.popupSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Z(this,t,[{popupSelector:r}]))._popUpImageZoom=n._popUp.querySelector(".pop-up__image-zoom"),n._popUpImageTitle=n._popUp.querySelector(".pop-up__image-title"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(t,e),n=t,r=[{key:"open",value:function(e){var n,r,o,i=e.link,u=e.name;this._popUpImageZoom.src=i,this._popUpImageZoom.alt=u,this._popUpImageTitle.textContent=u,(n=t,r=this,o=H(M(1&3?n.prototype:n),"open",r),function(e){return o.apply(r,e)})([])}}],r&&z(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(q);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function Y(e){var t=function(e){if("object"!=W(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(t)?t:t+""}function $(e,t,n){return t=re(t),function(e,t){if(t&&("object"==W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ee()?Reflect.construct(t,n||[],re(e).constructor):t.apply(e,n))}function ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ee=function(){return!!e})()}function te(e,t,n,r){var o=ne(re(1&r?e.prototype:e),t,n);return 2&r?function(e){return o.apply(n,e)}:o}function ne(){return ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=re(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ne.apply(null,arguments)}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}function oe(e,t){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oe(e,t)}var ie=function(e){function t(e){var n,r=e.popupSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$(this,t,[{popupSelector:r}]))._formElement=n._popUp.querySelector(".pop-up__form"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(t,e),n=t,(r=[{key:"open",value:function(e){te(t,"open",this,3)([]),this._handleDeleteSubmit=e}},{key:"setEventListeners",value:function(){var e=this;te(t,"setEventListeners",this,3)([]),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._handleDeleteSubmit(),e.close()}))}}])&&X(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(q);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ce(r.key),r)}}function ce(e){var t=function(e){if("object"!=ue(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ue(t)?t:t+""}var le=function(){return e=function e(t){var n=t.nameSelector,r=t.jobSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameSelector=n,this._jobSelector=r},(t=[{key:"getUserInfo",value:function(){return{name:this._nameSelector.textContent,job:this._jobSelector.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.job;this._nameSelector.textContent=t,this._jobSelector.textContent=n}}])&&ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pe(r.key),r)}}function pe(e){var t=function(e){if("object"!=se(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==se(t)?t:t+""}var ye=new(function(){return e=function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=n,this.headers=r},(t=[{key:"getUserInfo",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"updateUserProfile",value:function(e,t){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"createCard",value:function(e,t){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({link:e,name:t})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"deleteCardLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"addCardLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).catch((function(e){console.log(e)}))}}])&&fe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())({baseUrl:"https://around.nomoreparties.co/v1/web-es-cohort-15",headers:{authorization:"2bab9430-e1e0-4cbe-a60f-39a600fbd8a4","Content-Type":"application/json"}}),me=document.querySelector(".profile__avatar"),de=null,he=null,be=new le({nameSelector:l,jobSelector:s});ye.getUserInfo().then((function(e){de=e,be.setUserInfo({name:e.name,job:e.about}),me.src=e.avatar,ye.getInitialCards().then((function(e){(he=new P({items:e,renderer:function(e){var t=new r(e,"#card__template",de,{handleCardClick:function(e,t){return _e.open({link:e,name:t})},handleDeleteCard:function(e,t){ve.open((function(){ye.deleteCard(e).then((function(){t()}))}))},handleAddLike:function(e){return ye.addCardLike(e)},handleRemoveLike:function(e){return ye.deleteCardLike(e)}}).createCard();he.addItem(t)}},o)).renderItems()}))}));var ve=new ie({popupSelector:d});ve.setEventListeners();var _e=new Q({popupSelector:a});_e.setEventListeners();var Se=new F({popupSelector:y,handleFormSubmit:function(e){return ye.createCard(e.link,e.title).then((function(e){var t=new r(e,"#card__template",de,{handleCardClick:function(e,t){return _e.open({link:e,name:t})},handleDeleteCard:function(e,t){ve.open((function(){ye.deleteCard(e).then((function(){t()}))}))},handleAddLike:function(e){return ye.addCardLike(e)},handleRemoveLike:function(e){return ye.deleteCardLike(e)}}).createCard();o.prepend(t)}))}});m.addEventListener("click",(function(){we(v),Se.open()})),Se.setEventListeners();var ge=new F({popupSelector:i,handleFormSubmit:function(e){return ye.updateUserProfile(e.name,e.about).then((function(e){be.setUserInfo({name:e.name,job:e.about})}))}});u.addEventListener("click",(function(){we(v),ge.open();var e=be.getUserInfo();f.value=e.name,p.value=e.job})),ge.setEventListeners();var Ee=new F({popupSelector:h,handleFormSubmit:function(e){return ye.updateAvatar(e.link).then((function(e){document.querySelector(".profile__avatar").src=e.avatar})).catch((function(e){return console.error(e)}))}});b.addEventListener("click",(function(){Ee.open()})),Ee.setEventListeners();var we=function(e){document.querySelectorAll(e.formElement).forEach((function(t){new E(e,t).enableValidation()}))};we(v)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNGLEVBR0FBLEdBQWlCdkgsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENyZWFyIFRhcmpldGFzIEluaWNpYWxlc1xuZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBjYXJkRGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgdXNlcixcbiAgICB7IGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgaGFuZGxlQWRkTGlrZSwgaGFuZGxlUmVtb3ZlTGlrZSB9XG4gICkge1xuICAgIHRoaXMuX2NhcmREYXRhID0gY2FyZERhdGE7XG4gICAgdGhpcy5fc3JjID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9hbHQgPSBgaW1hZ2VuIGRlICR7Y2FyZERhdGEubmFtZX1gO1xuICAgIHRoaXMuX3RleHQgPSBjYXJkRGF0YS5uYW1lO1xuICAgIHRoaXMuX3VzZXIgPSB1c2VyO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gICAgdGhpcy5faGFuZGxlQWRkTGlrZSA9IGhhbmRsZUFkZExpa2U7XG4gICAgdGhpcy5faGFuZGxlUmVtb3ZlTGlrZSA9IGhhbmRsZVJlbW92ZUxpa2U7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3Bob3RvXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX3NyYywgdGhpcy5fdGV4dCk7XG4gICAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbi1oZWFydFwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKGV2dCk7XG4gICAgICB9KTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2J1dHRvbi10cmFzaFwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICAgIC8vIFRvbWEgY29tbyBwYXLDoW1ldHJvIGVsIGlkIGRlIGxhIHRhcmpldGEgeSBzaSBlcyBlbCBtw61vLCBib3JyYXLDoSBsYSB0YXJqZXRhXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZERhdGEuX2lkLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8vIE1hbmVqYSBlbCBib3TDs24gZGUgJ2xpa2UnXG4gIF9oYW5kbGVMaWtlQ2FyZChldnQpIHtcbiAgICBjb25zdCBjb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2NvdW50ZXJcIik7XG5cbiAgICAvLyBTaSBtaSB1c3VhcmlvIHlhIGxlIGRpbyBsaWtlLCBlbGltaW5hbG9cbiAgICBpZiAodGhpcy5fY2FyZERhdGEubGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXIuX2lkKSkge1xuICAgICAgdGhpcy5faGFuZGxlUmVtb3ZlTGlrZSh0aGlzLl9jYXJkRGF0YS5faWQpLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkO1xuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoXCJlbGVtZW50X19idXR0b24taGVhcnRfYWN0aXZlXCIpO1xuICAgICAgICBjb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fY2FyZERhdGEubGlrZXMubGVuZ3RoO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNpIG1pIHVzdWFyaW8gbm8gbGUgZGlvIGxpa2UsIGFncmVnYWxvXG4gICAgICB0aGlzLl9oYW5kbGVBZGRMaWtlKHRoaXMuX2NhcmREYXRhLl9pZCkudGhlbigoY2FyZCkgPT4ge1xuICAgICAgICB0aGlzLl9jYXJkRGF0YSA9IGNhcmQ7XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmFkZChcImVsZW1lbnRfX2J1dHRvbi1oZWFydF9hY3RpdmVcIik7XG4gICAgICAgIGNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9jYXJkRGF0YS5saWtlcy5sZW5ndGg7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBNw6l0b2RvIHBhcmEgZWwgYm90w7NuIGRlIGVsaW1pbmFyIHRhcmpldGFcbiAgX2hhbmRsZURlbGV0ZUNhcmQoZXZ0KSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19waG90b1wiKS5zcmMgPSB0aGlzLl9zcmM7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3Bob3RvXCIpLmFsdCA9IHRoaXMuX2FsdDtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdGV4dFwiKS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG5cbiAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24tdHJhc2hcIik7XG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19idXR0b24taGVhcnRcIik7XG5cbiAgICAvL1NpIGxhIHRhcmpldGEgbm8gdGllbmUgbWkgaWQsIG5vIGFwYXJlY2UgZWwgYm90w7NuIGRlIGVsaW1pbmFyXG4gICAgaWYgKHRoaXMuX3VzZXIuX2lkICE9PSB0aGlzLl9jYXJkRGF0YS5vd25lci5faWQpIHtcbiAgICAgIHRyYXNoQnV0dG9uLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8vIFZlcmlmaWNhIHNpIGVsIHVzdWFyaW8gYWN0dWFsIHlhIGhhIGRhZG8gXCJtZSBndXN0YVwiIGEgZXN0YSB0YXJqZXRhLFxuICAgIC8vIFNpIGVzIGFzw60sIG11ZXN0cmEgZWwgYm90w7NuIGRlIFwibWUgZ3VzdGFcIiBjb21vIGFjdGl2b1xuICAgIGlmICh0aGlzLl9jYXJkRGF0YS5saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlci5faWQpKSB7XG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19idXR0b24taGVhcnRfYWN0aXZlXCIpO1xuICAgICAgY29uc3QgY291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19jb3VudGVyXCIpO1xuICAgICAgY291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2NhcmREYXRhLmxpa2VzLmxlbmd0aDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiLy9Db250ZW5lZG9yIGRlIFRhcmpldGFzXG5jb25zdCBjYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c1wiKTtcblxuLy8gRm9ybXVsYXJpbyAnRWRpdGFyIFBlcmZpbCdcbmNvbnN0IHBvcFVwUHJvZmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9wVXAtUHJvZmlsZVwiKTtcbmV4cG9ydCBjb25zdCBvcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcblxuLy9Qb3AgVXAgWm9vbSBJbWFnZW5cbmNvbnN0IHBvcFVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWltYWdlXCIpO1xuY29uc3QgcG9wVXBJbWFnZUNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcC11cF9faW1hZ2Utem9vbVwiKTtcbmNvbnN0IHBvcFVwSW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19pbWFnZS10aXRsZVwiKTtcblxuY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcC11cF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mby1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2luZm8tcGFyYWdyYXBoXCIpO1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19mb3JtLWl0ZW0tbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19mb3JtLWl0ZW0tYWJvdXRcIik7XG5cbi8vIEVsZW1lbnRvcyBkZWwgcG9wVXAgY2FyZCdcbmNvbnN0IHBvcFVwQ2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9wVXAtQ2FyZFwiKTtcbmNvbnN0IGZvcm1BZGRDYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb3BVcC1Gb3JtXCIpO1xuY29uc3QgQnV0dG9uQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuLy8gRm9ybXVsYXJpbyAnQ29uZmlybWFjacOzbiBCb3JyYXIgQ2FyZCAnXG5leHBvcnQgY29uc3QgcG9wVXBDb25maXJtYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcFVwLURlbGV0ZVwiKTtcbi8vIEZvcm11bGFyaW8gJ0FjdHVhbGl6YXIgQXZhdGFyJ1xuZXhwb3J0IGNvbnN0IHBvcFVwQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb3BVcC1BdmF0YXJcIik7XG5leHBvcnQgY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhcl91cGRhdGVcIik7XG5cbmV4cG9ydCBjb25zdCBmb3JtQ29uZmlnID0ge1xuICBmb3JtRWxlbWVudDogXCIucG9wLXVwX19mb3JtXCIsXG4gIGlucHV0RWxlbWVudDogXCIucG9wLXVwX19mb3JtLWl0ZW1cIixcbiAgc3VibWl0QnV0dG9uOiBcIi5wb3AtdXBfX3NhdmUtYnV0dG9uXCIsXG4gIGVycm9yTm9kZTogXCIucG9wLXVwX19mb3JtLWVycm9yX1wiLFxuICBlcnJvckNsYXNzOiBcInBvcC11cF9fZm9ybS1pdGVtX2Vycm9yXCIsXG59O1xuXG5leHBvcnQge1xuICBwb3BVcEltYWdlQ29udGVudCxcbiAgcG9wVXBJbWFnZVRpdGxlLFxuICBwb3BVcEltYWdlLFxuICBjYXJkQ29udGFpbmVyLFxuICBmb3JtQWRkQ2FyZCxcbiAgcG9wVXBDYXJkLFxuICBCdXR0b25BZGRDYXJkLFxuICBwb3BVcFByb2ZpbGUsXG59O1xuIiwiY29uc3QgZm9ybUNvbmZpZyA9IHtcbiAgZm9ybUVsZW1lbnQ6IFwiLnBvcC11cF9fZm9ybVwiLFxuICBpbnB1dEVsZW1lbnQ6IFwiLnBvcC11cF9fZm9ybS1pdGVtXCIsXG4gIHN1Ym1pdEJ1dHRvbjogXCIucG9wLXVwX19zYXZlLWJ1dHRvblwiLFxuICBlcnJvck5vZGU6IFwiLnBvcC11cF9fZm9ybS1lcnJvcl9cIixcbiAgZXJyb3JDbGFzczogXCJwb3AtdXBfX2Zvcm0taXRlbV9lcnJvclwiLFxufTtcblxuZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihmb3JtQ29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1Db25maWcgPSBmb3JtQ29uZmlnO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXG4gICAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvcm1Db25maWcuaW5wdXRFbGVtZW50KVxuICAgICk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtQ29uZmlnLnN1Ym1pdEJ1dHRvbik7XG4gIH1cblxuICAvLyBNw6l0b2RvIHByaXZhZG8gcGFyYSBtb3N0cmFyIGVsIGVycm9yXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25NZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JOb2RlID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAke3RoaXMuX2Zvcm1Db25maWcuZXJyb3JOb2RlfSR7aW5wdXRFbGVtZW50Lm5hbWV9YFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZm9ybUNvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBlcnJvck5vZGUudGV4dENvbnRlbnQgPSB2YWxpZGF0aW9uTWVzc2FnZTtcbiAgfVxuXG4gIC8vIE3DqXRvZG8gcHJpdmFkbyBwYXJhIGVzY29uZGVyIGVsIGVycm9yXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck5vZGUgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCR7dGhpcy5fZm9ybUNvbmZpZy5lcnJvck5vZGV9JHtpbnB1dEVsZW1lbnQubmFtZX1gXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtQ29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yTm9kZS50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICAvLyBNw6l0b2RvIHByaXZhZG8gcGFyYSB2YWxpZGFyIGxhcyBlbnRyYWRhcyBkZWwgdXN1YXJpb1xuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgLy8gTcOpdG9kbyBwcml2YWRvIHBhcmEgdmVyaWZpY2FyIHNpIGhheSBlbnRyYWRhcyBpbnbDoWxpZGFzXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxlbWVudHMuc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIE3DqXRvZG8gcHJpdmFkbyBwYXJhIGhhYmlsaXRhci9kZXNoYWJpbGl0YXIgZWwgYm90w7NuIGRlIGVudsOtb1xuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVsZW1lbnRzKSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gTcOpdG9kbyBwcml2YWRvIHBhcmEgYWdyZWdhciBldmVudCBsaXN0ZW5lcnMgYSBsYXMgZW50cmFkYXMgZGVsIGZvcm11bGFyaW9cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIE3DqXRvZG8gcMO6YmxpY28gcGFyYSBhY3RpdmFyIGxhIHZhbGlkYWNpw7NuIGRlbCBmb3JtdWxhcmlvXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5ID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXJTZWxlY3RvcjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcFVwID0gcG9wdXBTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3BVcC5xdWVyeVNlbGVjdG9yKFwiLnBvcC11cF9fY2xvc2UtYnV0dG9uXCIpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3BVcC5jbGFzc0xpc3QuYWRkKFwicG9wLXVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3BVcC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wLXVwX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gTGlzdGVuZXIgcGFyYSBlbCBib3TDs24gZGUgY2llcnJlXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIC8vIExpc3RlbmVyIHBhcmEgY2VycmFyIGVsIHBvcHVwIGhhY2llbmRvIGNsaWMgZnVlcmEgZGVsIGNvbnRlbmlkb1xuICAgIHRoaXMuX3BvcFVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3AtdXBcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3BVcC5xdWVyeVNlbGVjdG9yKFwiLnBvcC11cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcC11cF9fZm9ybS1pdGVtXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTsgLy8gQ3JlYSB1biBvYmpldG8gdmFjw61vXG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19zYXZlLWJ1dHRvblwiKS50ZXh0Q29udGVudCA9XG4gICAgICAgIFwiR3VhcmRhbmRvLi4uXCI7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcC11cF9fc2F2ZS1idXR0b25cIikudGV4dENvbnRlbnQgPVxuICAgICAgICAgIFwiR3VhcmRhclwiO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3BVcEltYWdlWm9vbSA9IHRoaXMuX3BvcFVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19pbWFnZS16b29tXCIpO1xuICAgIHRoaXMuX3BvcFVwSW1hZ2VUaXRsZSA9IHRoaXMuX3BvcFVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wLXVwX19pbWFnZS10aXRsZVwiKTtcbiAgfVxuXG4gIC8vIEV2ZW50byBwYXJhIGFicmlyIGVsIHBvcC11cCBkZSB6b29tIGRlIGltYWdlblxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XG4gICAgdGhpcy5fcG9wVXBJbWFnZVpvb20uc3JjID0gbGluaztcbiAgICB0aGlzLl9wb3BVcEltYWdlWm9vbS5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX3BvcFVwSW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wVXAucXVlcnlTZWxlY3RvcihcIi5wb3AtdXBfX2Zvcm1cIik7XG4gIH1cblxuICBvcGVuKGhhbmRsZURlbGV0ZVN1Ym1pdCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQgPSBoYW5kbGVEZWxldGVTdWJtaXQ7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KCk7XG5cbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVTZWxlY3RvciA9IG5hbWVTZWxlY3RvcjtcbiAgICB0aGlzLl9qb2JTZWxlY3RvciA9IGpvYlNlbGVjdG9yO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVTZWxlY3Rvci50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iU2VsZWN0b3IudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICB0aGlzLl9uYW1lU2VsZWN0b3IudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYlNlbGVjdG9yLnRleHRDb250ZW50ID0gam9iO1xuICB9XG59XG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzaSBlbCBzZXJ2aWRvciBkZXZ1ZWx2ZSB1biBlcnJvciwgcmVjaGF6YSBlbCBwcm9taXNlXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJQcm9maWxlKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgfSk7XG4gIH1cblxuICBjcmVhdGVDYXJkKGxpbmssIG5hbWUpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGxpbmssXG4gICAgICAgIG5hbWUsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2kgZWwgc2Vydmlkb3IgZGV2dWVsdmUgdW4gZXJyb3IsIHJlY2hhemEgZWwgcHJvbWlzZVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzaSBlbCBzZXJ2aWRvciBkZXZ1ZWx2ZSB1biBlcnJvciwgcmVjaGF6YSBlbCBwcm9taXNlXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzaSBlbCBzZXJ2aWRvciBkZXZ1ZWx2ZSB1biBlcnJvciwgcmVjaGF6YSBlbCBwcm9taXNlXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBzaSBlbCBzZXJ2aWRvciBkZXZ1ZWx2ZSB1biBlcnJvciwgcmVjaGF6YSBlbCBwcm9taXNlXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2kgZWwgc2Vydmlkb3IgZGV2dWVsdmUgdW4gZXJyb3IsIHJlY2hhemEgZWwgcHJvbWlzZVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYi1lcy1jb2hvcnQtMTVcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMmJhYjk0MzAtZTFlMC00Y2JlLWE2MGYtMzlhNjAwZmJkOGE0XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuZXhwb3J0IGRlZmF1bHQgYXBpO1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQge1xuICBjYXJkQ29udGFpbmVyLFxuICBmb3JtQ29uZmlnLFxuICBwb3BVcEltYWdlLFxuICBwb3BVcENhcmQsXG4gIEJ1dHRvbkFkZENhcmQsXG4gIHBvcFVwUHJvZmlsZSxcbiAgb3BlbkJ1dHRvbixcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVKb2IsXG4gIG5hbWVJbnB1dCxcbiAgam9iSW5wdXQsXG4gIHBvcFVwQ29uZmlybWF0aW9uLFxuICBwb3BVcEF2YXRhcixcbiAgYXZhdGFySW1hZ2UsXG59IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IGFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IGF2YXRhck5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcblxuLy8gU2UgaW5pY2lhbGl6YW4gdmFyaWFibGVzIHNpbiBkYXRvcyBwYXJhIGFzaWduYXJzZWxvcyBkZXNwdcOpc1xubGV0IGN1cnJlbnRVc2VyID0gbnVsbDtcbmxldCBjYXJkTGlzdCA9IG51bGw7XG5cbi8vIE1hbmVqYSBsYSBpbmZvcm1hY2nDs24gZGVsIHVzdWFyaW9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBwcm9maWxlTmFtZSxcbiAgam9iU2VsZWN0b3I6IHByb2ZpbGVKb2IsXG59KTtcblxuLy8gTXVlc3RyYSBsYSBpbmZvcm1hY2nDs24gZGVsIFVzdWFyaW9cbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXIpID0+IHtcbiAgY3VycmVudFVzZXIgPSB1c2VyO1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IHVzZXIubmFtZSwgam9iOiB1c2VyLmFib3V0IH0pO1xuICBhdmF0YXJOb2RlLnNyYyA9IHVzZXIuYXZhdGFyO1xuXG4gIC8vIENyZWEgbGFzIHRhcmpldGFzIGluaWNpYWxlc1xuICBhcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigoY2FyZHMpID0+IHtcbiAgICBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZEl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZEl0ZW0sIFwiI2NhcmRfX3RlbXBsYXRlXCIsIGN1cnJlbnRVc2VyLCB7XG4gICAgICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6IChzcmMsIHRleHQpID0+XG4gICAgICAgICAgICAgIHBvcHVwSW1hZ2Uub3Blbih7XG4gICAgICAgICAgICAgICAgbGluazogc3JjLFxuICAgICAgICAgICAgICAgIG5hbWU6IHRleHQsXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgaGFuZGxlRGVsZXRlQ2FyZDogKGNhcmRJZCwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgZGVsZXRlRm9ybS5vcGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFuZGxlQWRkTGlrZTogKGNhcmRJZCkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gYXBpLmFkZENhcmRMaWtlKGNhcmRJZCk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBoYW5kbGVSZW1vdmVMaWtlOiAoY2FyZElkKSA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBhcGkuZGVsZXRlQ2FyZExpa2UoY2FyZElkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuY3JlYXRlQ2FyZCgpO1xuXG4gICAgICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY2FyZENvbnRhaW5lclxuICAgICk7XG5cbiAgICAvLyBSZW5kZXJpemEgbGFzIHRhcmpldGFzIGluaWNpYWxlcyBlbiBlbCBET01cbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuICB9KTtcbn0pO1xuXG4vLyBQb3AgVXAgZGUgQ29uZmlybWFjacOzbiBwYXJhIEVsaW1pbmFyIFRhcmpldGFcbmNvbnN0IGRlbGV0ZUZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wVXBDb25maXJtYXRpb24sXG59KTtcbmRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gUG9wVXAgY29uIEltYWdlbiBab29tXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogcG9wVXBJbWFnZSxcbn0pO1xucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBZ3JlZ2FyIHRhcmpldGFzXG5jb25zdCBhZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBwb3BVcENhcmQsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChmb3JtRGF0YSkgPT4ge1xuICAgIHJldHVybiBhcGkuY3JlYXRlQ2FyZChmb3JtRGF0YS5saW5rLCBmb3JtRGF0YS50aXRsZSkudGhlbigoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgbmV3Q2FyZEluc3RhbmNlID0gbmV3IENhcmQoY2FyZCwgXCIjY2FyZF9fdGVtcGxhdGVcIiwgY3VycmVudFVzZXIsIHtcbiAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoc3JjLCB0ZXh0KSA9PlxuICAgICAgICAgIHBvcHVwSW1hZ2Uub3Blbih7XG4gICAgICAgICAgICBsaW5rOiBzcmMsXG4gICAgICAgICAgICBuYW1lOiB0ZXh0LFxuICAgICAgICAgIH0pLFxuICAgICAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZElkLCBjYWxsYmFjaykgPT4ge1xuICAgICAgICAgIGRlbGV0ZUZvcm0ub3BlbigoKSA9PiB7XG4gICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGhhbmRsZUFkZExpa2U6IChjYXJkSWQpID0+IHtcbiAgICAgICAgICByZXR1cm4gYXBpLmFkZENhcmRMaWtlKGNhcmRJZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGFuZGxlUmVtb3ZlTGlrZTogKGNhcmRJZCkgPT4ge1xuICAgICAgICAgIHJldHVybiBhcGkuZGVsZXRlQ2FyZExpa2UoY2FyZElkKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBuZXdjYXJkRWxlbWVudCA9IG5ld0NhcmRJbnN0YW5jZS5jcmVhdGVDYXJkKCk7XG5cbiAgICAgIGNhcmRDb250YWluZXIucHJlcGVuZChuZXdjYXJkRWxlbWVudCk7XG4gICAgfSk7XG4gIH0sXG59KTtcbkJ1dHRvbkFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZW5hYmxlVmFsaWRhdGlvbihmb3JtQ29uZmlnKTtcbiAgYWRkQ2FyZC5vcGVuKCk7XG59KTtcbmFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gRWRpdGFyIGVsIFBlcmZpbFxuY29uc3QgZWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHBvcFVwUHJvZmlsZSxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgcmV0dXJuIGFwaVxuICAgICAgLnVwZGF0ZVVzZXJQcm9maWxlKGlucHV0VmFsdWVzLm5hbWUsIGlucHV0VmFsdWVzLmFib3V0KVxuICAgICAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiB1c2VyLm5hbWUsIGpvYjogdXNlci5hYm91dCB9KTtcbiAgICAgICAgLy9lZGl0UHJvZmlsZS5jbG9zZSgpO1xuICAgICAgfSk7XG4gIH0sXG59KTtcbm9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZW5hYmxlVmFsaWRhdGlvbihmb3JtQ29uZmlnKTtcbiAgZWRpdFByb2ZpbGUub3BlbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIG5hbWVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIGpvYklucHV0LnZhbHVlID0gdXNlckRhdGEuam9iO1xufSk7XG5lZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBY3R1YWxpemFyIGZvdG8gZGUgcGVyZmlsIGRlbCBhdmF0YXJcbmNvbnN0IGF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHBvcFVwQXZhdGFyLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICByZXR1cm4gYXBpXG4gICAgICAudXBkYXRlQXZhdGFyKGlucHV0VmFsdWVzLmxpbmspXG4gICAgICAudGhlbigodXNlcikgPT4ge1xuICAgICAgICAvLyBBY3R1YWxpemEgZWwgRE9NIGNvbiBsYSBudWV2YSBpbWFnZW4gZGVsIGF2YXRhclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKS5zcmMgPSB1c2VyLmF2YXRhcjtcbiAgICAgICAgLy9hdmF0YXJGb3JtLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gIH0sXG59KTtcblxuYXZhdGFySW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgLy8gZW5hYmxlVmFsaWRhdGlvbihmb3JtQ29uZmlnKTtcbiAgYXZhdGFyRm9ybS5vcGVuKCk7XG59KTtcblxuYXZhdGFyRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBY3RpdmEgbGEgdmFsaWRhY2nDs24gZW4gdG9kb3MgbG9zIGZvcm11bGFyaW9zIC0gSW5zdGFjaWEgbGEgdmFsaWRhY2nDs24gZGUgY2FkYSBmb3JtXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGZvcm1Db25maWcpID0+IHtcbiAgY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvcm1Db25maWcuZm9ybUVsZW1lbnQpO1xuICBmb3Jtcy5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQ29uZmlnLCBmb3JtRWxlbWVudCk7XG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIH0pO1xufTtcblxuLy8gSGFiaWxpdGEgbGEgdmFsaWRhY2nDs24gcGFyYSB0b2RvcyBsb3MgZm9ybXVsYXJpb3NcbmVuYWJsZVZhbGlkYXRpb24oZm9ybUNvbmZpZyk7XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwidXNlciIsIl9yZWYiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlQWRkTGlrZSIsImhhbmRsZVJlbW92ZUxpa2UiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2NhcmREYXRhIiwiX3NyYyIsImxpbmsiLCJfYWx0IiwiY29uY2F0IiwibmFtZSIsIl90ZXh0IiwiX3VzZXIiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZUFkZExpa2UiLCJfaGFuZGxlUmVtb3ZlTGlrZSIsImtleSIsInZhbHVlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl90aGlzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwiX2hhbmRsZUxpa2VDYXJkIiwiX2lkIiwicmVtb3ZlIiwiX3RoaXMyIiwiY291bnRlciIsImxpa2VzIiwic29tZSIsImxpa2UiLCJ0aGVuIiwiY2FyZCIsInRhcmdldCIsImNsYXNzTGlzdCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiYWRkIiwiX3RoaXMzIiwiX2dldFRlbXBsYXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwic3JjIiwiYWx0IiwidHJhc2hCdXR0b24iLCJsaWtlQnV0dG9uIiwib3duZXIiLCJjYXJkQ29udGFpbmVyIiwicG9wVXBQcm9maWxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJvcGVuQnV0dG9uIiwicG9wVXBJbWFnZSIsImZvcm1FbGVtZW50IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlSm9iIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJwb3BVcENhcmQiLCJCdXR0b25BZGRDYXJkIiwicG9wVXBDb25maXJtYXRpb24iLCJwb3BVcEF2YXRhciIsImF2YXRhckltYWdlIiwiZm9ybUNvbmZpZyIsImlucHV0RWxlbWVudCIsInN1Ym1pdEJ1dHRvbiIsImVycm9yTm9kZSIsImVycm9yQ2xhc3MiLCJGb3JtVmFsaWRhdG9yIiwiX2Zvcm1Db25maWciLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImV2ZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaW5pdGlhbEFycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW0iLCJlbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJjbG9zZSIsIl9wb3BVcCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfY2xvc2VCdXR0b24iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiX1BvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9jYWxsU3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJfaW5oZXJpdHMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwiX3N1cGVyUHJvcEdldCIsInByZXZlbnREZWZhdWx0IiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3BVcEltYWdlWm9vbSIsIl9wb3BVcEltYWdlVGl0bGUiLCJfcmVmMiIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVEZWxldGVTdWJtaXQiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVTZWxlY3RvciIsIl9qb2JTZWxlY3RvciIsImpvYiIsIkFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiZmV0Y2giLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2FyZElkIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImF2YXRhck5vZGUiLCJjdXJyZW50VXNlciIsImNhcmRMaXN0IiwidXNlckluZm8iLCJhcGkiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwiY2FyZHMiLCJjYXJkSXRlbSIsImNhcmRFbGVtZW50IiwidGV4dCIsInBvcHVwSW1hZ2UiLCJvcGVuIiwiY2FsbGJhY2siLCJkZWxldGVGb3JtIiwiZGVsZXRlQ2FyZCIsImFkZENhcmRMaWtlIiwiZGVsZXRlQ2FyZExpa2UiLCJjcmVhdGVDYXJkIiwiYWRkSXRlbSIsInJlbmRlckl0ZW1zIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRDYXJkIiwiZm9ybURhdGEiLCJ0aXRsZSIsIm5ld2NhcmRFbGVtZW50IiwicHJlcGVuZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlZGl0UHJvZmlsZSIsImlucHV0VmFsdWVzIiwidXBkYXRlVXNlclByb2ZpbGUiLCJ1c2VyRGF0YSIsImF2YXRhckZvcm0iLCJ1cGRhdGVBdmF0YXIiLCJlcnIiXSwic291cmNlUm9vdCI6IiJ9